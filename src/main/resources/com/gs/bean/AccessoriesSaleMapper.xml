<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gs.dao.AccessoriesSaleDAO">

    <resultMap id="accessoriesSaleResultMap" type="com.gs.bean.AccessoriesSale">
        <id property="accSaleId" column="accSaleId"/>
        <result property="accId" column="accId"/>
        <result property="accSaledTime" column="accSaledTime"/>
        <result property="accSaleCount" column="accSaleCount"/>
        <result property="accSalePrice" column="accSalePrice"/>
        <result property="accSaleTotal" column="accSaleTotal"/>
        <result property="accSaleDiscount" column="accSaleDiscount"/>
        <result property="accSaleMoney" column="accSaleMoney"/>
        <result property="accSaleCreatedTime" column="accSaleCreatedTime"/>
        <result property="companyId" column="companyId"/>
        <result property="accSaleStatus" column="accSaleStatus"/>
        <result property="userId" column="userId"/>
        <result property="userName" column="userName"/>
        <result property="userPhone" column="userPhone"/>

        <association property="accessories" javaType="com.gs.bean.Accessories">
            <id property="accId" column="accId"/>
            <result property="accName" column="accName"/>
            <result property="accCommodityCode" column="accCommodityCode"/>
            <result property="accPrice" column="accPrice"/>
            <result property="accSalePrice" column="accSalePrice"/>
            <result property="accUnit" column="accUnit"/>
            <result property="accTotal" column="accTotal"/>
            <result property="accIdle" column="accIdle"/>
            <result property="accTypeId" column="accTypeId"/>
            <result property="companyId" column="companyId"/>
            <result property="accStatus" column="accStatus"/>


            <association property="accessoriesType" javaType="com.gs.bean.AccessoriesType">
                <id property="accTypeId" column="accTypeId"/>
                <result property="accTypeName" column="accTypeName"/>
            </association>
        </association>

        <association property="user" javaType="com.gs.bean.User">
            <id property="userId" column="userId"/>
            <result property="userName" column="userName"/>
            <result property="userPhone" column="userPhone"/>
        </association>

    </resultMap>

    <insert id="insert" parameterType="accessoriesSale">
		insert into
		auto_platform.t_accessories_sale
		(accSaleId, accId, accSaledTime, accSaleCount, accSalePrice, accSaleTotal, accSaleDiscount, accSaleMoney, accSaleCreatedTime, companyId, accSaleStatus, userId, userName, userPhone)
		values
		(#{accSaleId}, #{accId}, #{accSaledTime}, #{accSaleCount}, #{accSalePrice}, #{accSaleTotal}, #{accSaleDiscount}, #{accSaleMoney}, now(), #{companyId}, 'Y', #{userId}, #{userName}, #{userPhone})
	</insert>

    <insert id="batchInsert" parameterType="list">
		<![CDATA[

        ]]>
	</insert>

    <delete id="delete" parameterType="accessoriesSale">
		<![CDATA[

        ]]>
	</delete>

    <delete id="deleteById" parameterType="string">
		<![CDATA[

        ]]>
	</delete>

    <delete id="batchDelete" parameterType="list">
		<![CDATA[

        ]]>
	</delete>

    <update id="update" parameterType="accessoriesSale">
		<![CDATA[

        ]]>
	</update>

    <update id="batchUpdate" parameterType="list">
		<![CDATA[

        ]]>
	</update>

    <select id="queryAll" resultMap="accessoriesSaleResultMap">
		<![CDATA[

		select * from auto_platform.t_accessories_sale;

        ]]>
	</select>

    <select id="queryByStatus" resultMap="accessoriesSaleResultMap" parameterType="string">
		<![CDATA[

		select * from t_accessories_sale where accSaleStatus = #{status}

        ]]>
	</select>

    <select id="query" parameterType="accessoriesSale" resultType="accessoriesSale">
		<![CDATA[

        ]]>
	</select>

    <select id="queryById" parameterType="string" resultType="accessoriesSale">
		<![CDATA[

		select * from t_accessories_type where accSaleId = #{id}

        ]]>
	</select>

    <select id="queryByPager" resultType="list" resultMap="accessoriesSaleResultMap"
            parameterType="com.gs.common.bean.Pager">
		<![CDATA[

           SELECT
            ase.*,
            ace.accName,
            ate.accTypeId,
            ate.accTypeName,
            usr.userName,
            ace.accId,
            ace.accUnit,
            ace.accIdle
            FROM
                (
                    (
                        t_accessories_sale ase
                        INNER JOIN t_accessories ace ON ase.accId = ace.accId
                    )
                    INNER JOIN t_accessories_type ate ON ace.accTypeId = ate.accTypeId
                )
            LEFT JOIN t_user usr ON ase.userId = usr.userId
            order by ase.accSaledTime
            limit
             #{beginIndex},#{pageSize}

        ]]>

    </select>

    <select id="count" resultType="int">
        select count(*) from auto_platform.t_accessories_sale
    </select>

    <update id="inactive" parameterType="string">
		<![CDATA[

        ]]>
	</update>

    <update id="active" parameterType="string">
		<![CDATA[

        ]]>
	</update>

    <select id="queryByUserIdIsSameResult" resultType="int">
--         select count(*) from t_accessories_sale ase inner join t_user usr on ase.userId = usr.userId where usr.userId = #{id}
        select count(*) from t_accessories_sale ase where ase.userId = #{id} and ase.userName = #{userName}
    </select>

</mapper>
